# 4장 종합연습문제
# 1번
select ENAME
from emp
where MGR is null;

# 2번
select ENAME,
	(select DNAME
    from DEPT D
    where D.DEPTNO = E.DEPTNO) as DNAME
from EMP E;

# 3번
#조인
SELECT E.ENAME
FROM EMP E
JOIN DEPT D ON E.DEPTNO = D.DEPTNO
WHERE D.LOC = 'CHICAGO';

#인라인
select ENAME
from (
	select E.ENAME, D.LOC
    from EMP E
    join DEPT D on E.DEPTNO = D.DEPTNO
    ) as Sub
where Sub.LOC = 'CHICAGO';

#중첩질의
SELECT ENAME
FROM EMP
WHERE DEPTNO IN (
    SELECT DEPTNO
    FROM DEPT
    WHERE LOC = 'CHICAGO'
);

#EXITSTS
SELECT E.ENAME
FROM EMP E
WHERE EXISTS (
    SELECT 1
    FROM DEPT D
    WHERE D.DEPTNO = E.DEPTNO
      AND D.LOC = 'CHICAGO'
);


# 4번
select ENAME, SAL
from EMP
where SAL > (
	select AVG(SAL)
    from EMP
);

#5번
select E.ENAME, E.DEPTNO, E.SAL
from EMP E
where E.SAL > (
	select avg(E2.SAL)
    from EMP E2
    where E2.DEPTNO = E.DEPTNO
);


